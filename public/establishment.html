<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taste Test - <%= establishment.name %></title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <script src="script.js"></script>
</head>
<body>
    <div class="background">
        <div class="nav-bar-green">
            <nav>
                <div class="logo-name-white">
                    <i class="fi fi-sr-hamburger-soda nav-logo-white" onclick="feed()"></i>
                    <h1>Taste Test</h1>
                </div>
            </nav>
        </div>
        <div class="res-content">
            <div class="res-content-top">
                <div class="overlay-green"></div>
                <h1><%= establishment.name %></h1>
                <div class="res-top-info">
                    <div class="res-page-loc">
                        <i class="fi fi-sr-marker green-icon loc-feed"></i>
                        <p><%= establishment.location %></p>
                    </div> 
                    <div class="res-full-gallery">
                        <i class="fi fi-rr-angle-left white-icon" onclick="galleryback()"></i>
                        <div class="res-gallery">
                            <% establishment.images.forEach(function(image) { %>
                                <div><img src="<%= image %>" alt="Gallery Image"></div>
                            <% }); %>
                        </div>
                        <i class="fi fi-rr-angle-right white-icon" onclick="gallerynext()"></i>
                    </div>
                    <!-- Dynamic Rating Display Here -->
                </div>         
            </div>
            <div class="res-content-bottom">
                <h1>About</h1>
                <p><%= establishment.about %></p>
                <h1>Cuisine</h1>
                <ul>
                    <% establishment.cuisine.forEach(function(type) { %>
                        <li><%= type %></li>
                    <% }); %>
                </ul>
                <h1>Popular Menu Items</h1>
                <ul>
                    <% establishment.popularItems.forEach(function(item) { %>
                        <li><%= item %></li>
                    <% }); %>
                </ul>
                <br>
                <div class="res-rev-header">
                    <h1>Reviews</h1>
                    <!-- Sort By Functionality (requires JavaScript implementation) -->
                </div>
                <form action="/establishments/<%= establishment._id %>/reviews" method="POST">
                    <label for="rating">Rating:</label>
                    <select name="rating" id="rating" required>
                        <option value="5">5 Stars</option>
                        <option value="4">4 Stars</option>
                        <option value="3">3 Stars</option>
                        <option value="2">2 Stars</option>
                        <option value="1">1 Star</option>
                    </select>
                    <label for="title">Title:</label>
                    <input type="text" id="title" name="title" required>
                    <label for="body">Review:</label>
                    <textarea id="body" name="body" required></textarea>
                    <button type="submit">Submit Review</button>
                </form>
                <div class="reviews">
                    <% reviews.forEach(function(review) { %>
                        <div class="review">
                            <h3><%= review.title %></h3>
                            <p>Rating: <%= review.rating %></p>
                            <p><%= review.body %></p>
                        </div>
                    <% }); %>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

